<div class="container mt-5" *ngIf="customer$ | async as c; else loading">
  <div class="d-flex justify-content-between align-items-center p-3">
    <h3 class="mb-0">Customer Detail</h3>
    <div class="d-flex justify-content-end">
      <a [routerLink]="['/edit-customer', c.id]" class="btn btn-outline-success me-2">Edit</a>
      <a routerLink="/all-customers" class="btn btn-outline-primary me-2">Back</a>
    </div>
  </div>
  <div class="row g-3">
    <div class="col-md-4">
      <div class="card shadow-sm">
        <div class="card-header">Profile</div>
        <div class="card-body">
          <p><strong>ID:</strong> {{ c.id }}</p>
          <p><strong>Name:</strong> {{ c.name }}</p>
          <p><strong>Username:</strong> {{ c.username }}</p>
          <p><strong>Role:</strong> {{ c.role }}</p>
          <p><strong>Active:</strong> {{ c.isActive ? 'Yes' : 'No' }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card shadow-sm mb-3">
        <div class="card-header d-flex justify-content-between align-items-center">
          <span>Active Rental</span>
        </div>
        <div class="card-body">
          <ng-container *ngIf="activeRental$ | async as ar; else noActive">
            <div class="row align-items-center">
              <div class="col">
                <p class="mb-1"><strong>Equipment:</strong> {{ ar.equipmentId }}</p>
                <p class="mb-1"><strong>Issued:</strong> {{ ar.issuedAt | date : 'mediumDate' }}</p>
                <p class="mb-1"><strong>Due:</strong> {{ ar.dueDate | date : 'mediumDate' }}</p>
              </div>
              <div class="col-auto">
                <a [routerLink]="['/rental-return', ar.id]" class="btn btn-warning">Return</a>
              </div>
            </div>
          </ng-container>
          <ng-template #noActive>
            <div class="text-muted">No active rental.</div>
          </ng-template>
        </div>
      </div>
      <div class="card shadow-sm">
        <div class="card-header">Rental History</div>
        <div class="card-body">
          <div *ngIf="!c.rentals || c.rentals.length === 0" class="text-muted">
            No rentals found.
          </div>
          <div *ngIf="c.rentals && c.rentals.length > 0">
            <div class="table-responsive">
              <table class="table table-sm align-middle">
                <thead>
                  <tr>
                    <th>Rental #</th>
                    <th>Equipment</th>
                    <th>Status</th>
                    <th>Issued</th>
                    <th>Due</th>
                    <th>Returned</th>
                  </tr>
                </thead>
                <tbody>
<!--                  <tr *ngFor="let r of c.rentals">-->
<!--                    <td>{{ r.id }}</td>-->
<!--                    <td>{{ r.equipmentName }} ({{ r.equipmentId }})</td>-->
<!--                    <td>{{ r.status }}</td>-->
<!--                    <td>{{ r.issuedAt | date : 'mediumDate' }}</td>-->
<!--                    <td>{{ r.dueDate | date : 'mediumDate' }}</td>-->
<!--                    <td>{{ r.returnedAt ? (r.returnedAt | date : 'mediumDate') : '-' }}</td>-->
<!--                  </tr>-->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #loading>
  <div class="container mt-4">Loading...</div>
</ng-template>
